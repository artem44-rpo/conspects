### Структура разделов жесткого диска: MBR и GPT

###### Схема MBR (Master Boot Record)

Классическая схема, используемая с BIOS. Находится в самом первом секторе диска.

```
+-------------------------------------------------------+
|                 MASTER BOOT RECORD (MBR)              |
|                   (Первые 512 байт)                   |
+----------------------------------------+--------------+
|                                        |              |
|          Загрузчик (Boot Code)         | Таблица      |
|             (446 байт)                 | разделов     |
|                                        | (64 байта)   |
|                                        |              |
+----------------------------------------+--------------+
| Раздел 1 | Раздел 2 | Раздел 3 | Расширенный раздел...|
+-------------------------------------------------------+
```

###### Схема GPT (GUID Partition Table)

Современный стандарт, являющийся частью спецификации UEFI. Данные дублируются в начале и в конце диска для надежности.

```
+-------------------------------------------------------+
| LBA 0 |       Protective MBR (Защитный MBR)           |
+-------+-----------------------------------------------+
| LBA 1 |       Primary GPT Header (Первичный заголовок)|
+-------+-----------------------------------------------+
| LBA 2 |                                               |
| ...   |       Partition Entry Array                   |
| LBA 33|       (Массив записей о разделах)             |
+-------+-----------------------------------------------+
|       |                                               |
|       |              РАЗДЕЛЫ ДИСКА                    |
|       |       (Файловые системы, Данные)              |
|       |                                               |
+-------+-----------------------------------------------+
| LBA -33|      Backup Partition Entry Array            |
| ...    |      (Резервный массив записей)              |
| LBA -2 |                                              |
+--------+----------------------------------------------+
| LBA -1 |      Backup GPT Header (Резервный заголовок) |
+--------+----------------------------------------------+
```

###### Таблица разделов GPT (Подробно)

**GPT (GUID Partition Table)** — это стандарт формата размещения таблиц разделов на физическом жестком диске. Он пришел на смену MBR вместе с внедрением интерфейса UEFI (вместо BIOS).

**Ключевые особенности строения:**

1. **Protective MBR (Защитный MBR):**  
    Самый первый сектор диска (LBA 0) все еще содержит структуру MBR. Это сделано для обратной совместимости и защиты. Старые утилиты, не знающие о GPT, увидят этот сектор и будут считать, что весь диск занят одним большим разделом, что предотвратит случайную перезапись данных.
    
2. **Первичный заголовок (Primary GPT Header):**  
    Находится в секторе LBA 1. Он содержит:
    
    - Уникальный идентификатор диска (GUID).
    - Информацию о размере и расположении самой таблицы разделов.
    - Контрольную сумму (CRC32) заголовка и таблицы разделов для проверки целостности данных. Если сумма не сойдется, система поймет, что данные повреждены, и обратится к резервной копии.
3. **Массив записей о разделах (Partition Entries):**  
    Занимает сектора с LBA 2 по LBA 33. Здесь хранится информация о каждом разделе: начальный и конечный адреса, тип раздела и его имя. В отличие от MBR, где разделы ограничены, GPT выделяет достаточно места для создания до 128 разделов без использования «костылей» вроде расширенных разделов.
    
4. **Резервная копия (Backup Area):**  
    В самом конце диска (последние 34 сектора) хранится точная копия таблицы разделов и заголовка. Если первичные данные в начале диска будут повреждены (например, bad-блоки), система восстановит структуру из конца диска.
    

###### Преимущества GPT перед MBR

- **Объем диска:** Поддерживает диски объемом более 2 ТБ (теоретический предел — 9.4 Зеттабайт). MBR видит только 2.2 ТБ.
- **Количество разделов:** Позволяет создавать до 128 первичных разделов (в Windows), тогда как MBR — только 4.
- **Надежность:** Хранит дубликат таблицы разделов в конце диска и использует контрольные суммы (CRC32) для выявления ошибок.
- **Идентификация:** Использует уникальные длинные идентификаторы (GUID) для каждого раздела, что исключает конфликты имен.